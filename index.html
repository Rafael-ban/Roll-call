<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="light dark">
    <title>不那么智能的智能考勤系统</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
<div class="container">
    <div class="header">
        <h1>不那么智能的智能考勤系统</h1>
        <p>上传名单、记录出勤、保存查询</p>
    </div>
    
    <div class="content">
        <div class="course-info">
            <input type="text" id="courseName" placeholder="课程名称（如：数据结构）">
            <div class="date-time-container">
                <input type="date" id="courseDate" placeholder="日期">
                <input type="time" id="courseTime" placeholder="时间">
            </div>
            <input type="text" id="classroom" placeholder="课室（如：1号楼201）">
            <input type="text" id="counselor" placeholder="辅导员姓名">
            <input type="text" id="classInfo" placeholder="专业班级（如：计算机科学与技术1班）">
        </div>
        
        <div class="file-upload">
            <h2>上传名单文件</h2>
            <div class="file-input">
                <label for="studentList">总名单（支持txt和xlsx格式）</label>
                <input type="file" id="studentList" accept=".txt,.xlsx" />
                <div id="studentListError" class="error-message"></div>
            </div>
            
            <div class="file-input">
                <h2>通用标记名单</h2>
                <label for="manualAbsenceList">请输入需要标记的学生姓名（支持换行或空格分隔）</label>
                <textarea id="manualAbsenceList" class="absence-textarea" placeholder="例如：
张三 李四 王五
或
张三
李四
王五"></textarea>
            </div>
        </div>
        
        <div class="button-group">
            <button id="loadLists" class="btn-primary">加载名单</button>
            <div class="mark-grid">
                <button id="markAbsent" class="btn-secondary">标记请假</button>
                <button id="markLate" class="btn-secondary">标记迟到</button>
                <button id="markLeave" class="btn-secondary">标记早退</button>
                <button id="markMissing" class="btn-secondary">标记缺勤</button>
            </div>
            <button type="button" id="invertSelectionButton" class="btn-secondary">反选状态</button>
            <button id="saveAttendance" class="btn-success">保存出勤记录</button>
            <button id="exportFullExcel" class="btn-success">保存完整出勤记录表</button>
        </div>
        
        <div class="attendance-section">
            <h2>出勤记录</h2>
            <table class="attendance-list" id="attendanceTable">
                <thead>
                    <tr>
                        <th style="width: 60%">姓名</th>
                        <th style="width: 40%">出勤状态</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- 动态加载内容 -->
                </tbody>
            </table>
        </div>
    </div>
    
    <div class="footer">
        不那么智能的智能点名系统 © 2025
        <div>Made with ❤️ by <a href="https://github.com/Rafael-ban" target="_blank">Rafael-ban</a></div>
        <div>系统已稳定运行 <span id="runningDays" class="running-days">0</span> 天</div>
    </div>
</div>

<!-- 引入外部库和脚本 -->
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<script src="script.js"></script>

</body>
</html>